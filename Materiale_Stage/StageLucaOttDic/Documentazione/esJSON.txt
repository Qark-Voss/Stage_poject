SELECT G2_TOT_REG.GG_GIORNO, G2_TOT_REG.TOT_REG, G2_TOT_INI.TOT_INI, G2_TOT_END.TOT_END FROM (SELECT G2_GIORNI.GG_GIORNO, count(*) AS TOT_REG FROM (SELECT DISTINCT CAST(IN_DT_REG AS DATE) - CAST(START_DATE AS DATE) AS GG_GIORNO FROM SS_INTERVENTI, (SELECT min(SS_INTERVENTI.IN_DT_REG) AS START_DATE FROM SS_INTERVENTI WHERE ((SS_INTERVENTI.IN_RELEASE = '4'))) G2_STARTDATE WHERE ((SS_INTERVENTI.IN_RELEASE = '4' AND SS_INTERVENTI.IN_STATO in ('IN','LA','TE','CO'))) UNION SELECT DISTINCT CAST(IN_DT_TERMINE AS DATE) - CAST(START_DATE AS DATE) AS GG_GIORNO FROM SS_INTERVENTI, (SELECT min(SS_INTERVENTI.IN_DT_REG) AS START_DATE FROM SS_INTERVENTI WHERE ((SS_INTERVENTI.IN_RELEASE = '4'))) G2_STARTDATE WHERE ((SS_INTERVENTI.IN_RELEASE = '4' AND SS_INTERVENTI.IN_STATO in ('IN','LA','TE','CO') AND CAST(IN_DT_TERMINE AS DATE) - CAST(START_DATE AS DATE) is not null))) G2_GIORNI, (SELECT SS_INTERVENTI.IN_CODICE, SS_INTERVENTI.IN_TITOLO, CAST(IN_DT_REG AS DATE) - CAST(START_DATE AS DATE) AS GG_REG, CAST(IN_DT_INIZIO AS DATE) - CAST(START_DATE AS DATE) AS GG_INI, CAST(IN_DT_TERMINE AS DATE) - CAST(START_DATE AS DATE) AS GG_END FROM SS_INTERVENTI, (SELECT min(SS_INTERVENTI.IN_DT_REG) AS START_DATE FROM SS_INTERVENTI WHERE ((SS_INTERVENTI.IN_RELEASE = '4'))) G2_STARTDATE WHERE ((SS_INTERVENTI.IN_RELEASE = '4' AND SS_INTERVENTI.IN_STATO in ('IN','LA','TE','CO')))) G2_INTERVENTI WHERE ((G2_GIORNI.GG_GIORNO>=G2_INTERVENTI.GG_REG)) GROUP BY G2_GIORNI.GG_GIORNO) G2_TOT_REG, (SELECT G2_GIORNI.GG_GIORNO, count(*) AS TOT_INI FROM ((SELECT DISTINCT CAST(IN_DT_REG AS DATE) - CAST(START_DATE AS DATE) AS GG_GIORNO FROM SS_INTERVENTI, (SELECT min(SS_INTERVENTI.IN_DT_REG) AS START_DATE FROM SS_INTERVENTI WHERE ((SS_INTERVENTI.IN_RELEASE = '4'))) G2_STARTDATE WHERE ((SS_INTERVENTI.IN_RELEASE = '4' AND SS_INTERVENTI.IN_STATO in ('IN','LA','TE','CO'))) UNION SELECT DISTINCT CAST(IN_DT_TERMINE AS DATE) - CAST(START_DATE AS DATE) AS GG_GIORNO FROM SS_INTERVENTI, (SELECT min(SS_INTERVENTI.IN_DT_REG) AS START_DATE FROM SS_INTERVENTI WHERE ((SS_INTERVENTI.IN_RELEASE = '4'))) G2_STARTDATE WHERE ((SS_INTERVENTI.IN_RELEASE = '4' AND SS_INTERVENTI.IN_STATO in ('IN','LA','TE','CO') AND CAST(IN_DT_TERMINE AS DATE) - CAST(START_DATE AS DATE) is not null))) G2_GIORNI LEFT OUTER JOIN (SELECT SS_INTERVENTI.IN_CODICE, SS_INTERVENTI.IN_TITOLO, CAST(IN_DT_REG AS DATE) - CAST(START_DATE AS DATE) AS GG_REG, CAST(IN_DT_INIZIO AS DATE) - CAST(START_DATE AS DATE) AS GG_INI, CAST(IN_DT_TERMINE AS DATE) - CAST(START_DATE AS DATE) AS GG_END FROM SS_INTERVENTI, (SELECT min(SS_INTERVENTI.IN_DT_REG) AS START_DATE FROM SS_INTERVENTI WHERE ((SS_INTERVENTI.IN_RELEASE = '4'))) G2_STARTDATE WHERE ((SS_INTERVENTI.IN_RELEASE = '4' AND SS_INTERVENTI.IN_STATO in ('IN','LA','TE','CO')))) G2_INTERVENTI ON G2_GIORNI.GG_GIORNO>=G2_INTERVENTI.GG_INI) GROUP BY G2_GIORNI.GG_GIORNO) G2_TOT_INI , (SELECT G2_GIORNI.GG_GIORNO, count(*) AS TOT_END FROM ((SELECT DISTINCT CAST(IN_DT_REG AS DATE) - CAST(START_DATE AS DATE) AS GG_GIORNO FROM SS_INTERVENTI, (SELECT min(SS_INTERVENTI.IN_DT_REG) AS START_DATE FROM SS_INTERVENTI WHERE ((SS_INTERVENTI.IN_RELEASE = '4'))) G2_STARTDATE WHERE ((SS_INTERVENTI.IN_RELEASE = '4' AND SS_INTERVENTI.IN_STATO in ('IN','LA','TE','CO'))) UNION SELECT DISTINCT CAST(IN_DT_TERMINE AS DATE) - CAST(START_DATE AS DATE) AS GG_GIORNO FROM SS_INTERVENTI, (SELECT min(SS_INTERVENTI.IN_DT_REG) AS START_DATE FROM SS_INTERVENTI WHERE ((SS_INTERVENTI.IN_RELEASE = '4'))) G2_STARTDATE WHERE ((SS_INTERVENTI.IN_RELEASE = '4' AND SS_INTERVENTI.IN_STATO in ('IN','LA','TE','CO') AND CAST(IN_DT_TERMINE AS DATE) - CAST(START_DATE AS DATE) is not null))) G2_GIORNI LEFT OUTER JOIN (SELECT SS_INTERVENTI.IN_CODICE, SS_INTERVENTI.IN_TITOLO, CAST(IN_DT_REG AS DATE) - CAST(START_DATE AS DATE) AS GG_REG, CAST(IN_DT_INIZIO AS DATE) - CAST(START_DATE AS DATE) AS GG_INI, CAST(IN_DT_TERMINE AS DATE) - CAST(START_DATE AS DATE) AS GG_END FROM SS_INTERVENTI, (SELECT min(SS_INTERVENTI.IN_DT_REG) AS START_DATE FROM SS_INTERVENTI WHERE ((SS_INTERVENTI.IN_RELEASE = '4'))) G2_STARTDATE WHERE ((SS_INTERVENTI.IN_RELEASE = '4' AND SS_INTERVENTI.IN_STATO in ('IN','LA','TE','CO')))) G2_INTERVENTI ON G2_GIORNI.GG_GIORNO>=G2_INTERVENTI.GG_END) GROUP BY G2_GIORNI.GG_GIORNO) G2_TOT_END WHERE ((G2_TOT_REG.GG_GIORNO=G2_TOT_INI.GG_GIORNO AND G2_TOT_REG.GG_GIORNO=G2_TOT_END.GG_GIORNO)) 